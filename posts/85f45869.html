<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>在R语言中使用ggplot2绘图 | 甘露园技术栈</title><meta name="author" content="乘月又乘风"><meta name="copyright" content="乘月又乘风"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="In order to focus on the construction of the different plots and the use of &#123;ggplot2&#125;, we will restrict ourselves to drawing basic (yet beautiful) plots without unnecessary layers. For the s">
<meta property="og:type" content="article">
<meta property="og:title" content="在R语言中使用ggplot2绘图">
<meta property="og:url" content="https://lambda.bz/posts/85f45869.html">
<meta property="og:site_name" content="甘露园技术栈">
<meta property="og:description" content="In order to focus on the construction of the different plots and the use of &#123;ggplot2&#125;, we will restrict ourselves to drawing basic (yet beautiful) plots without unnecessary layers. For the s">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://tron.oss-cn-beijing.aliyuncs.com/2024/04/26/gabriel-heinzer.webp">
<meta property="article:published_time" content="2024-04-27T18:25:57.000Z">
<meta property="article:modified_time" content="2024-05-06T02:58:46.300Z">
<meta property="article:author" content="乘月又乘风">
<meta property="article:tag" content="R">
<meta property="article:tag" content="ggplot2">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://tron.oss-cn-beijing.aliyuncs.com/2024/04/26/gabriel-heinzer.webp"><link rel="shortcut icon" href="/image/favicon.ico"><link rel="canonical" href="https://lambda.bz/posts/85f45869.html"><link rel="preconnect" href="https://cdn.bootcss.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://cdn.bootcss.com/font-awesome/6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.bootcss.com/fancyapps-ui/5.0.33/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  noticeOutdate: {"limitDay":500,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":50,"languages":{"author":"作者: 乘月又乘风","link":"链接: ","source":"来源: 甘露园技术栈","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.bootcss.com/egjs-infinitegrid/4.11.1/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '在R语言中使用ggplot2绘图',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-05-06 10:58:46'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="manifest" href="/site.webmanifest"><link rel="stylesheet" media="defer" onload="this.media='all'"><link rel="stylesheet" href="/css/universe.css"><link rel="stylesheet" href="/css/custom.css"><link rel="stylesheet" href="/css/modified.css"><link rel="stylesheet" href="/css/background.css"><link href="https://cdn.bootcdn.net/ajax/libs/lxgw-wenkai-screen-webfont/1.7.0/style.min.css" rel="stylesheet"><script src="https://cdn.bootcss.com/pace/1.0.2/pace.min.js" async></script><script src="https://cdn.bootcdn.net/ajax/libs/echarts/5.4.3/echarts.min.js"></script><meta name="generator" content="Hexo 7.1.1"><link rel="alternate" href="/atom.xml" title="甘露园技术栈" type="application/atom+xml">
<link rel="alternate" href="/rss2.xml" title="甘露园技术栈" type="application/rss+xml">
</head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><script>(()=>{
  const $loadingBox = document.getElementById('loading-box')
  const $body = document.body
  const preloader = {
    endLoading: () => {
      $body.style.overflow = ''
      $loadingBox.classList.add('loaded')
    },
    initLoading: () => {
      $body.style.overflow = 'hidden'
      $loadingBox.classList.remove('loaded')
    }
  }

  preloader.initLoading()
  window.addEventListener('load',() => { preloader.endLoading() })

  if (false) {
    document.addEventListener('pjax:send', () => { preloader.initLoading() })
    document.addEventListener('pjax:complete', () => { preloader.endLoading() })
  }
})()</script><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://tron.oss-cn-beijing.aliyuncs.com/2024/04/26/me.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">11</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">15</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">8</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/songs/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li><li><a class="site-page child" href="/games/"><i class="fa-fw fa-brands fa-fantasy-flight-games"></i><span> 游戏</span></a></li><li><a class="site-page child" href="/books/"><i class="fa-fw fas fa-book"></i><span> 书籍</span></a></li><li><a class="site-page child" href="/photos/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 链接</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><span> 关于</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></li><li><a class="site-page child" href="/charts/"><i class="fa-fw fa-solid fa-chart-simple"></i><span> 统计</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://tron.oss-cn-beijing.aliyuncs.com/2024/04/26/gabriel-heinzer.webp')"><nav id="nav"><span id="blog-info"><a href="/" title="甘露园技术栈"><img class="site-icon" src= "/image/800x600-loading-81.gif" data-lazy-src="https://tron.oss-cn-beijing.aliyuncs.com/2024/04/25/loogo-ngb.png"/></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/songs/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li><li><a class="site-page child" href="/games/"><i class="fa-fw fa-brands fa-fantasy-flight-games"></i><span> 游戏</span></a></li><li><a class="site-page child" href="/books/"><i class="fa-fw fas fa-book"></i><span> 书籍</span></a></li><li><a class="site-page child" href="/photos/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 链接</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><span> 关于</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></li><li><a class="site-page child" href="/charts/"><i class="fa-fw fa-solid fa-chart-simple"></i><span> 统计</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">在R语言中使用ggplot2绘图</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-04-27T18:25:57.000Z" title="发表于 2024-04-28 02:25:57">2024-04-28</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-05-06T02:58:46.300Z" title="更新于 2024-05-06 10:58:46">2024-05-06</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/R-Code/">R Code</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">4.3k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>27分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="在R语言中使用ggplot2绘图"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>In order to focus on the construction of the different plots and the use of <code>&#123;ggplot2&#125;</code>, we will restrict ourselves to drawing basic (yet beautiful) plots without unnecessary layers. For the sake of completeness, we will briefly discuss and illustrate different layers to further personalize a plot at the end of the article (see this <a target="_blank" rel="noopener" href="https://statsandr.com/blog/graphics-in-r-with-ggplot2/#further-personalization">section</a>).</p>
<p>Note that if you still struggle to create plots with <code>&#123;ggplot2&#125;</code> after reading this tutorial, you may find the <a target="_blank" rel="noopener" href="https://statsandr.com/blog/rstudio-addins-or-how-to-make-your-coding-life-easier/#esquisse">{esquisse} addin</a> useful. This addin allows you to <strong>interactively</strong> (that is, by dragging and dropping variables) create plots with the <code>&#123;ggplot2&#125;</code> package. Give it a try!</p>
<h2 id="Scatter-plot"><a href="#Scatter-plot" class="headerlink" title="Scatter plot"></a>Scatter plot</h2><p>We start by creating a <a target="_blank" rel="noopener" href="https://statsandr.com/blog/descriptive-statistics-in-r/#scatterplot">scatter plot</a> using <code>geom_point</code>. Remember that a scatter plot is used to visualize the relation between two <a target="_blank" rel="noopener" href="https://statsandr.com/blog/variable-types-and-examples/#quantitative">quantitative variables</a>.</p>
<ol>
<li>We start by specifying the data:</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ggplot(dat) # data</span><br></pre></td></tr></table></figure>

<p><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://statsandr.com/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-4-1.png"></p>
<ol start="2">
<li>Then we add the variables to be represented with the <code>aes()</code> function:</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ggplot(dat) + # data</span><br><span class="line">  aes(x = displ, y = hwy) # variables</span><br></pre></td></tr></table></figure>

<p><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://statsandr.com/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-5-1.png"></p>
<ol start="3">
<li>Finally, we indicate the type of plot:</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ggplot(dat) + # data</span><br><span class="line">  aes(x = displ, y = hwy) + # variables</span><br><span class="line">  geom_point() # type of plot</span><br></pre></td></tr></table></figure>

<p><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://statsandr.com/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-6-1.png"></p>
<p>You will also sometimes see the aesthetic elements (<code>aes()</code> with the variables) inside the <code>ggplot()</code> function in addition to the dataset:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ggplot(mpg, aes(x = displ, y = hwy)) +</span><br><span class="line">  geom_point()</span><br></pre></td></tr></table></figure>

<p><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://statsandr.com/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-7-1.png"></p>
<p>This second method gives the exact same plot than the first method. I tend to prefer the first method over the second for better readability, but this is more a matter of taste so the choice is up to you.</p>
<h2 id="Line-plot"><a href="#Line-plot" class="headerlink" title="Line plot"></a>Line plot</h2><p><a target="_blank" rel="noopener" href="https://statsandr.com/blog/descriptive-statistics-in-r/#line-plot">Line plots</a>, particularly useful in time series or finance, can be created similarly but by using <code>geom_line()</code>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ggplot(dat) +</span><br><span class="line">  aes(x = displ, y = hwy) +</span><br><span class="line">  geom_line()</span><br></pre></td></tr></table></figure>

<p><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://statsandr.com/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-8-1.png"></p>
<p>(Note that this might not be the most appropriate plot since there are multiple points for each value of <code>displ</code>, but this is just an example to show how to create a line plot.)</p>
<h2 id="Combination-of-line-and-points"><a href="#Combination-of-line-and-points" class="headerlink" title="Combination of line and points"></a>Combination of line and points</h2><p>An advantage of <code>&#123;ggplot2&#125;</code> is the ability to combine several types of plots and its flexibility in designing it. For instance, we can add a line to a scatter plot by simply adding a layer to the initial scatter plot:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ggplot(dat) +</span><br><span class="line">  aes(x = displ, y = hwy) +</span><br><span class="line">  geom_point() +</span><br><span class="line">  geom_line() # add line</span><br></pre></td></tr></table></figure>

<p><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://statsandr.com/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-9-1.png"></p>
<h2 id="Histogram"><a href="#Histogram" class="headerlink" title="Histogram"></a>Histogram</h2><p>A <a target="_blank" rel="noopener" href="https://statsandr.com/blog/descriptive-statistics-in-r/#histogram">histogram</a> (useful to visualize distributions and detect potential <a target="_blank" rel="noopener" href="https://statsandr.com/blog/outliers-detection-in-r/">outliers</a>) can be plotted using <code>geom_histogram()</code>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ggplot(dat) +</span><br><span class="line">  aes(x = hwy) +</span><br><span class="line">  geom_histogram()</span><br></pre></td></tr></table></figure>

<p><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://statsandr.com/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-10-1.png"></p>
<p>By default, the number of bins is equal to 30. You can change this value using the <code>bins</code> argument inside the <code>geom_histogram()</code> function:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ggplot(dat) +</span><br><span class="line">  aes(x = hwy) +</span><br><span class="line">  geom_histogram(bins = round(sqrt(nrow(dat))))</span><br></pre></td></tr></table></figure>

<p><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://statsandr.com/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-11-1.png"></p>
<p>Here I specify the number of bins to be equal to the square root of the number of observations (following Sturge’s rule) but you can specify any integer number.</p>
<h2 id="Density-plot"><a href="#Density-plot" class="headerlink" title="Density plot"></a>Density plot</h2><p><a target="_blank" rel="noopener" href="https://statsandr.com/blog/descriptive-statistics-in-r/#density-plot">Density plots</a> can be created using <code>geom_density()</code>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ggplot(dat) +</span><br><span class="line">  aes(x = hwy) +</span><br><span class="line">  geom_density()</span><br></pre></td></tr></table></figure>

<p><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://statsandr.com/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-12-1.png"></p>
<h2 id="Combination-of-histogram-and-densities"><a href="#Combination-of-histogram-and-densities" class="headerlink" title="Combination of histogram and densities"></a>Combination of histogram and densities</h2><p>We can also superimpose a histogram and a density curve on the same plot:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ggplot(dat) +</span><br><span class="line">  aes(x = hwy, y = after_stat(density)) +</span><br><span class="line">  geom_histogram() +</span><br><span class="line">  geom_density()</span><br></pre></td></tr></table></figure>

<p><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://statsandr.com/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-13-1.png"></p>
<p>Or superimpose several densities:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ggplot(dat) +</span><br><span class="line">  aes(x = hwy, color = drv, fill = drv) +</span><br><span class="line">  geom_density(alpha = 0.25) # add transparency</span><br></pre></td></tr></table></figure>

<p><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://statsandr.com/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-14-1.png"></p>
<p>The argument <code>alpha = 0.25</code> has been added for some transparency. More information about this argument can be found in this <a target="_blank" rel="noopener" href="https://statsandr.com/blog/graphics-in-r-with-ggplot2/#further-personalization">section</a>.</p>
<h2 id="Dotplot"><a href="#Dotplot" class="headerlink" title="Dotplot"></a>Dotplot</h2><p>A <a target="_blank" rel="noopener" href="https://statsandr.com/blog/descriptive-statistics-in-r/#dotplot">dotplot</a> in <code>&#123;ggplot2&#125;</code> can be built with <code>geom_dotplot()</code>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># Dotplot for one variable</span><br><span class="line">ggplot(dat) +</span><br><span class="line">  aes(x = &quot;&quot;, y = hwy) +</span><br><span class="line">  geom_dotplot(binaxis = &quot;y&quot;, stackdir = &quot;center&quot;)</span><br></pre></td></tr></table></figure>

<p><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://statsandr.com/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-15-1.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># Dotplot by factor</span><br><span class="line">ggplot(dat) +</span><br><span class="line">  aes(x = drv, y = hwy) +</span><br><span class="line">  geom_dotplot(</span><br><span class="line">    binaxis = &quot;y&quot;, stackdir = &quot;center&quot;,</span><br><span class="line">    dotsize = 0.75 # decrease dot size</span><br><span class="line">  )</span><br></pre></td></tr></table></figure>

<p><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://statsandr.com/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-15-2.png"></p>
<p>Dotplots are more appropriate with small samples (because the plot may be hard to read with too many points). For large samples, a boxplot may be used.</p>
<p>For the interested reader, see many personalization that is possible with a dotplot in this <a target="_blank" rel="noopener" href="http://www.sthda.com/english/wiki/ggplot2-dot-plot-quick-start-guide-r-software-and-data-visualization">tutorial</a>.</p>
<h2 id="Boxplot"><a href="#Boxplot" class="headerlink" title="Boxplot"></a>Boxplot</h2><p>A <a target="_blank" rel="noopener" href="https://statsandr.com/blog/descriptive-statistics-in-r/#boxplot">boxplot</a> (also very useful to visualize distributions and detect potential <a target="_blank" rel="noopener" href="https://statsandr.com/blog/outliers-detection-in-r/">outliers</a>) can be plotted using <code>geom_boxplot()</code>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># Boxplot for one variable</span><br><span class="line">ggplot(dat) +</span><br><span class="line">  aes(x = &quot;&quot;, y = hwy) +</span><br><span class="line">  geom_boxplot()</span><br></pre></td></tr></table></figure>

<p><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://statsandr.com/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-16-1.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># Boxplot by factor</span><br><span class="line">ggplot(dat) +</span><br><span class="line">  aes(x = drv, y = hwy) +</span><br><span class="line">  geom_boxplot()</span><br></pre></td></tr></table></figure>

<p><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://statsandr.com/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-16-2.png"></p>
<p>It is also possible to plot the points on the boxplot with <code>geom_jitter()</code>, and to vary the width of the boxes according to the size (i.e., the number of observations) of each level with <code>varwidth = TRUE</code>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ggplot(dat) +</span><br><span class="line">  aes(x = drv, y = hwy) +</span><br><span class="line">  geom_boxplot(varwidth = TRUE) + # vary boxes width according to n obs.</span><br><span class="line">  geom_jitter(alpha = 0.25, width = 0.2) # adds random noise and limit its width</span><br></pre></td></tr></table></figure>

<p><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://statsandr.com/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-17-1.png"></p>
<p>The <code>geom_jitter()</code> layer adds some random variation to each point in order to prevent them from overlapping (an issue known as overplotting).<a target="_blank" rel="noopener" href="https://statsandr.com/blog/graphics-in-r-with-ggplot2/#fn1"><sup>1</sup></a> Moreover, the <code>alpha</code> argument adds some transparency to the points (see more in this <a target="_blank" rel="noopener" href="https://statsandr.com/blog/graphics-in-r-with-ggplot2/#further-personalization">section</a>) to keep the focus on the boxes and not on the points.</p>
<p>Finally, it is also possible to divide boxplots into several panels according to the levels of a <a target="_blank" rel="noopener" href="https://statsandr.com/blog/variable-types-and-examples/#qualitative">qualitative variable</a>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ggplot(dat) +</span><br><span class="line">  aes(x = drv, y = hwy) +</span><br><span class="line">  geom_boxplot(varwidth = TRUE) + # vary boxes width according to n obs.</span><br><span class="line">  geom_jitter(alpha = 0.25, width = 0.2) + # adds random noise and limit its width</span><br><span class="line">  facet_wrap(~year) # divide into 2 panels</span><br></pre></td></tr></table></figure>

<p><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://statsandr.com/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-18-1.png"></p>
<p>For a visually more appealing plot, it is also possible to use some colors for the boxes depending on the x variable:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ggplot(dat) +</span><br><span class="line">  aes(x = drv, y = hwy, fill = drv) + # add color to boxes with fill</span><br><span class="line">  geom_boxplot(varwidth = TRUE) + # vary boxes width according to n obs.</span><br><span class="line">  geom_jitter(alpha = 0.25, width = 0.2) + # adds random noise and limit its width</span><br><span class="line">  facet_wrap(~year) + # divide into 2 panels</span><br><span class="line">  theme(legend.position = &quot;none&quot;) # remove legend</span><br></pre></td></tr></table></figure>

<p><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://statsandr.com/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-19-1.png"></p>
<p>In that case, it best to remove the legend as it becomes redundant. See more information about the legend in this <a target="_blank" rel="noopener" href="https://statsandr.com/blog/graphics-in-r-with-ggplot2/#legend">section</a>.</p>
<p>If you are unhappy with the default colors provided in <code>&#123;ggplot2&#125;</code>, you can change them manually with the <code>scale_fill_manual()</code> layer:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ggplot(dat) +</span><br><span class="line">  aes(x = drv, y = hwy, fill = drv) + # add color to boxes with fill</span><br><span class="line">  geom_boxplot(varwidth = TRUE) + # vary boxes width according to n obs.</span><br><span class="line">  geom_jitter(alpha = 0.25, width = 0.2) + # adds random noise and limit its width</span><br><span class="line">  facet_wrap(~year) + # divide into 2 panels</span><br><span class="line">  theme(legend.position = &quot;none&quot;) + # remove legend</span><br><span class="line">  scale_fill_manual(values = c(&quot;darkred&quot;, &quot;darkgreen&quot;, &quot;steelblue&quot;)) # change fill color manually</span><br></pre></td></tr></table></figure>

<p><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://statsandr.com/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-20-1.png"></p>
<h2 id="Barplot"><a href="#Barplot" class="headerlink" title="Barplot"></a>Barplot</h2><p>A <a target="_blank" rel="noopener" href="https://statsandr.com/blog/descriptive-statistics-in-r/#barplot">barplot</a> (useful to visualize qualitative variables) can be plotted using <code>geom_bar()</code>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ggplot(dat) +</span><br><span class="line">  aes(x = drv) +</span><br><span class="line">  geom_bar()</span><br></pre></td></tr></table></figure>

<p><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://statsandr.com/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-21-1.png"></p>
<p>Bars’ heights correspond to the observed frequencies (i.e., the number of observations) for each level of the variable of interest (<code>drv</code> in our case).</p>
<p><strong>Tip</strong>: by default, the order of the bars follows the initial order (by alphabetical order or numerical order if you did not change it). If you want to order the levels by frequency (largest first), use the <code>fct_infreq()</code> function from the <code>&#123;forcats&#125;</code> package.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">library(forcats)</span><br><span class="line"></span><br><span class="line">ggplot(dat) +</span><br><span class="line">  aes(x = fct_infreq(drv)) + # order by frequency</span><br><span class="line">  geom_bar()</span><br></pre></td></tr></table></figure>

<p><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://statsandr.com/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-22-1.png"></p>
<p>If you want to order levels in an increasing order (i.e., category with the smallest frequency first), use the <code>fct_rev()</code> in addition to the <code>fct_infreq()</code> function:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ggplot(dat) +</span><br><span class="line">  aes(x = fct_rev(fct_infreq(drv))) + # order by frequency</span><br><span class="line">  geom_bar()</span><br></pre></td></tr></table></figure>

<p><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://statsandr.com/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-23-1.png"></p>
<p>(Label for the x-axis can then easily be edited with the <code>labs()</code> function. See <a target="_blank" rel="noopener" href="https://statsandr.com/blog/graphics-in-r-with-ggplot2/#title-and-axis-labels">below</a> for more information.)</p>
<p>Again, for a more appealing plot, we can add some colors to the bars with the <code>fill</code> argument:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ggplot(dat) +</span><br><span class="line">  aes(x = drv, fill = drv) + # add colors to bars</span><br><span class="line">  geom_bar() +</span><br><span class="line">  theme(legend.position = &quot;none&quot;) # remove legend</span><br></pre></td></tr></table></figure>

<p><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://statsandr.com/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-24-1.png"></p>
<p>We can also create a barplot with two qualitative variables:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ggplot(dat) +</span><br><span class="line">  aes(x = drv, fill = year) + # fill by years</span><br><span class="line">  geom_bar()</span><br></pre></td></tr></table></figure>

<p><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://statsandr.com/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-25-1.png"></p>
<p>In order to compare proportions across groups, it is best to make each bar the same height using <code>position = &quot;fill&quot;</code>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ggplot(dat) +</span><br><span class="line">  geom_bar(aes(x = drv, fill = year), position = &quot;fill&quot;)</span><br></pre></td></tr></table></figure>

<p><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://statsandr.com/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-26-1.png"></p>
<p>To draw the bars next to each other for each group, use <code>position = &quot;dodge&quot;</code>:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>dat<span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_bar<span class="punctuation">(</span>aes<span class="punctuation">(</span>x <span class="operator">=</span> drv<span class="punctuation">,</span> fill <span class="operator">=</span> year<span class="punctuation">)</span><span class="punctuation">,</span> position <span class="operator">=</span> <span class="string">&quot;dodge&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<p><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://statsandr.com/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-27-1.png"></p>
<h2 id="Raincloud-plot"><a href="#Raincloud-plot" class="headerlink" title="Raincloud plot"></a>Raincloud plot</h2><p>A raincloud plot is a graph that combines 3 visualizations:</p>
<ol>
<li>a density plot,</li>
<li>a boxplot,</li>
<li>and the raw data in the form of a dotplot or jittered points.</li>
</ol>
<p>The advantage of this plot is that it illustrates, <strong>all at once</strong>, the distribution (with the density curve), the summary measures (first, second and third <a target="_blank" rel="noopener" href="https://statsandr.com/blog/descriptive-statistics-in-r/#first-and-third-quartile">quartiles</a>, and maximum&#x2F;mininum without <a target="_blank" rel="noopener" href="https://statsandr.com/blog/outliers-detection-in-r/">outliers</a> thanks to the boxplot) and the number of observations (either via a dotplot or via jittered points).</p>
<p>Let’s illustrate the raincloud plot, first with jittered points (more appropriate with large samples):<a target="_blank" rel="noopener" href="https://statsandr.com/blog/graphics-in-r-with-ggplot2/#fn2"><sup>2</sup></a></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">library<span class="punctuation">(</span>tidyverse<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>ggdist<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># density plot:</span></span><br><span class="line">dat <span class="operator">%&gt;%</span></span><br><span class="line">  ggplot<span class="punctuation">(</span>aes<span class="punctuation">(</span>x <span class="operator">=</span> drv<span class="punctuation">,</span> y <span class="operator">=</span> hwy<span class="punctuation">,</span> fill <span class="operator">=</span> drv<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  stat_halfeye<span class="punctuation">(</span></span><br><span class="line">    adjust <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">,</span> <span class="comment"># set the smoothing parameter</span></span><br><span class="line">    width <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">,</span> <span class="comment"># set the height of the curves</span></span><br><span class="line">    justification <span class="operator">=</span> <span class="operator">-</span><span class="number">0.2</span><span class="punctuation">,</span> <span class="comment"># move curves to the right</span></span><br><span class="line">    .width <span class="operator">=</span> <span class="number">0</span><span class="punctuation">,</span> point_colour <span class="operator">=</span> <span class="literal">NA</span> <span class="comment"># remove interval present by default</span></span><br><span class="line">  <span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  <span class="comment"># boxplot:</span></span><br><span class="line">  geom_boxplot<span class="punctuation">(</span></span><br><span class="line">    width <span class="operator">=</span> <span class="number">0.12</span><span class="punctuation">,</span> <span class="comment"># width of boxes</span></span><br><span class="line">    outlier.color <span class="operator">=</span> <span class="literal">NA</span><span class="punctuation">,</span> <span class="comment"># remove color of outliers</span></span><br><span class="line">    alpha <span class="operator">=</span> <span class="number">0.5</span> <span class="comment"># add transparency</span></span><br><span class="line">  <span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  <span class="comment"># jittered points:</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>aes<span class="punctuation">(</span>colour <span class="operator">=</span> drv<span class="punctuation">)</span><span class="punctuation">,</span> <span class="comment"># add color on points</span></span><br><span class="line">    size <span class="operator">=</span> <span class="number">1.3</span><span class="punctuation">,</span> <span class="comment"># size of points</span></span><br><span class="line">    alpha <span class="operator">=</span> <span class="number">.3</span><span class="punctuation">,</span> <span class="comment"># add transparency</span></span><br><span class="line">    position <span class="operator">=</span> position_jitter<span class="punctuation">(</span> <span class="comment"># obtain shifted points</span></span><br><span class="line">      seed <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> <span class="comment"># set seed for same random representation</span></span><br><span class="line">      width <span class="operator">=</span> <span class="number">.09</span> <span class="comment"># manage the width of the offset</span></span><br><span class="line">    <span class="punctuation">)</span></span><br><span class="line">  <span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  <span class="comment"># further personalization:</span></span><br><span class="line">  coord_flip<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span> <span class="comment"># rotate plot</span></span><br><span class="line">  theme<span class="punctuation">(</span>legend.position <span class="operator">=</span> <span class="string">&quot;none&quot;</span><span class="punctuation">)</span> <span class="comment"># remove legend</span></span><br></pre></td></tr></table></figure>

<p><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://statsandr.com/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-28-1.png"></p>
<p>Now the same chart but with dotplots this time (more appropriate with small <a target="_blank" rel="noopener" href="https://statsandr.com/blog/what-is-the-difference-between-population-and-sample/">samples</a>):</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># density plot:</span></span><br><span class="line">dat <span class="operator">%&gt;%</span></span><br><span class="line">  sample_n<span class="punctuation">(</span><span class="number">100</span><span class="punctuation">)</span> <span class="operator">%&gt;%</span> <span class="comment"># random sample of size 100</span></span><br><span class="line">  ggplot<span class="punctuation">(</span>aes<span class="punctuation">(</span>x <span class="operator">=</span> drv<span class="punctuation">,</span> y <span class="operator">=</span> hwy<span class="punctuation">,</span> fill <span class="operator">=</span> drv<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  stat_halfeye<span class="punctuation">(</span></span><br><span class="line">    adjust <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">,</span> <span class="comment"># set the smoothing parameter</span></span><br><span class="line">    width <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">,</span> <span class="comment"># set the height of the curves</span></span><br><span class="line">    justification <span class="operator">=</span> <span class="operator">-</span><span class="number">0.2</span><span class="punctuation">,</span> <span class="comment"># move curves to the right</span></span><br><span class="line">    .width <span class="operator">=</span> <span class="number">0</span><span class="punctuation">,</span> point_colour <span class="operator">=</span> <span class="literal">NA</span> <span class="comment"># remove interval present by default</span></span><br><span class="line">  <span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  <span class="comment"># boxplot:</span></span><br><span class="line">  geom_boxplot<span class="punctuation">(</span></span><br><span class="line">    width <span class="operator">=</span> <span class="number">0.12</span><span class="punctuation">,</span> <span class="comment"># width of boxes</span></span><br><span class="line">    outlier.color <span class="operator">=</span> <span class="literal">NA</span><span class="punctuation">,</span> <span class="comment"># remove color of outliers</span></span><br><span class="line">    alpha <span class="operator">=</span> <span class="number">0.5</span> <span class="comment"># add transparency</span></span><br><span class="line">  <span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  <span class="comment"># dotplot:</span></span><br><span class="line">  stat_dots<span class="punctuation">(</span></span><br><span class="line">    dotsize <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">,</span> <span class="comment"># size of points</span></span><br><span class="line">    side <span class="operator">=</span> <span class="string">&quot;left&quot;</span><span class="punctuation">,</span> <span class="comment"># place points on opposite side of density curve</span></span><br><span class="line">    justification <span class="operator">=</span> <span class="number">1.1</span><span class="punctuation">,</span> <span class="comment"># move points away from boxplot</span></span><br><span class="line">    binwidth <span class="operator">=</span> <span class="number">1</span> <span class="comment"># group points together</span></span><br><span class="line">  <span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  <span class="comment"># further personalization:</span></span><br><span class="line">  coord_flip<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span> <span class="comment"># rotate plot</span></span><br><span class="line">  theme<span class="punctuation">(</span>legend.position <span class="operator">=</span> <span class="string">&quot;none&quot;</span><span class="punctuation">)</span> <span class="comment"># remove legend</span></span><br></pre></td></tr></table></figure>

<p><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://statsandr.com/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-29-1.png"></p>
<p>The code is much longer compared to the other plots, but the only line(s) to edit to adapt to your dataset is the aesthetics (<code>aes()</code>). The rest is mainly adjustments that should not be changed.</p>
<p>You may have notice that at the end of the code, there are some personalization which allow to improve the plot even further. The most common personalization are presented in the next section.</p>
<h2 id="Further-personalization"><a href="#Further-personalization" class="headerlink" title="Further personalization"></a>Further personalization</h2><h3 id="Title-and-axis-labels"><a href="#Title-and-axis-labels" class="headerlink" title="Title and axis labels"></a>Title and axis labels</h3><p>The first things to personalize in a plot is the labels to make the plot more informative to the audience. We can easily add a title, subtitle, caption and edit axis labels with the <code>labs()</code> function:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">p <span class="operator">&lt;-</span> ggplot<span class="punctuation">(</span>dat<span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  aes<span class="punctuation">(</span>x <span class="operator">=</span> displ<span class="punctuation">,</span> y <span class="operator">=</span> hwy<span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">p <span class="operator">+</span> labs<span class="punctuation">(</span></span><br><span class="line">  title <span class="operator">=</span> <span class="string">&quot;Fuel efficiency for 38 popular models of car&quot;</span><span class="punctuation">,</span></span><br><span class="line">  subtitle <span class="operator">=</span> <span class="string">&quot;Period 1999-2008&quot;</span><span class="punctuation">,</span></span><br><span class="line">  caption <span class="operator">=</span> <span class="string">&quot;Data: ggplot2::mpg. See more at statsandr.com&quot;</span><span class="punctuation">,</span></span><br><span class="line">  x <span class="operator">=</span> <span class="string">&quot;Engine displacement (litres)&quot;</span><span class="punctuation">,</span></span><br><span class="line">  y <span class="operator">=</span> <span class="string">&quot;Highway miles per gallon (mpg)&quot;</span></span><br><span class="line"><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<p><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://statsandr.com/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-30-1.png"></p>
<p>As you can see in the above code, you can save one or more layers of the plot in an object for later use.</p>
<p>This way, you can save your “main” plot, and add more layers of personalization until you get the desired output. Here we saved the main scatter plot in an object called <code>p</code> and we will refer to it for the subsequent personalization.</p>
<p>You can also edit the alignment, the size and the shape of the title and subtitle via the <code>theme()</code> layer and the <code>element_text()</code> function:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">p <span class="operator">+</span> labs<span class="punctuation">(</span></span><br><span class="line">  title <span class="operator">=</span> <span class="string">&quot;Fuel efficiency for 38 popular models of car&quot;</span><span class="punctuation">,</span></span><br><span class="line">  subtitle <span class="operator">=</span> <span class="string">&quot;Period 1999-2008&quot;</span><span class="punctuation">,</span></span><br><span class="line">  caption <span class="operator">=</span> <span class="string">&quot;Data: ggplot2::mpg. See more at statsandr.com&quot;</span><span class="punctuation">,</span></span><br><span class="line">  x <span class="operator">=</span> <span class="string">&quot;Engine displacement (litres)&quot;</span><span class="punctuation">,</span></span><br><span class="line">  y <span class="operator">=</span> <span class="string">&quot;Highway miles per gallon (mpg)&quot;</span></span><br><span class="line"><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span></span><br><span class="line">    plot.title <span class="operator">=</span> element_text<span class="punctuation">(</span></span><br><span class="line">      hjust <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">,</span> <span class="comment"># center</span></span><br><span class="line">      size <span class="operator">=</span> <span class="number">12</span><span class="punctuation">,</span></span><br><span class="line">      color <span class="operator">=</span> <span class="string">&quot;steelblue&quot;</span><span class="punctuation">,</span></span><br><span class="line">      face <span class="operator">=</span> <span class="string">&quot;bold&quot;</span></span><br><span class="line">    <span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    plot.subtitle <span class="operator">=</span> element_text<span class="punctuation">(</span></span><br><span class="line">      hjust <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">,</span> <span class="comment"># center</span></span><br><span class="line">      size <span class="operator">=</span> <span class="number">10</span><span class="punctuation">,</span></span><br><span class="line">      color <span class="operator">=</span> <span class="string">&quot;gray&quot;</span><span class="punctuation">,</span></span><br><span class="line">      face <span class="operator">=</span> <span class="string">&quot;italic&quot;</span></span><br><span class="line">    <span class="punctuation">)</span></span><br><span class="line">  <span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<p><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://statsandr.com/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-31-1.png"></p>
<p>If the title or subtitle is long and you want to divide it into multiple lines, use <code>\n</code>:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">p <span class="operator">+</span> labs<span class="punctuation">(</span></span><br><span class="line">  title <span class="operator">=</span> <span class="string">&quot;Fuel efficiency for 38 popular \n models of car&quot;</span><span class="punctuation">,</span></span><br><span class="line">  subtitle <span class="operator">=</span> <span class="string">&quot;Period 1999-2008&quot;</span><span class="punctuation">,</span></span><br><span class="line">  caption <span class="operator">=</span> <span class="string">&quot;Data: ggplot2::mpg. See more at statsandr.com&quot;</span><span class="punctuation">,</span></span><br><span class="line">  x <span class="operator">=</span> <span class="string">&quot;Engine displacement (litres)&quot;</span><span class="punctuation">,</span></span><br><span class="line">  y <span class="operator">=</span> <span class="string">&quot;Highway miles per gallon (mpg)&quot;</span></span><br><span class="line"><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span></span><br><span class="line">    plot.title <span class="operator">=</span> element_text<span class="punctuation">(</span></span><br><span class="line">      hjust <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">,</span> <span class="comment"># center</span></span><br><span class="line">      size <span class="operator">=</span> <span class="number">12</span><span class="punctuation">,</span></span><br><span class="line">      color <span class="operator">=</span> <span class="string">&quot;steelblue&quot;</span><span class="punctuation">,</span></span><br><span class="line">      face <span class="operator">=</span> <span class="string">&quot;bold&quot;</span></span><br><span class="line">    <span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    plot.subtitle <span class="operator">=</span> element_text<span class="punctuation">(</span></span><br><span class="line">      hjust <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">,</span> <span class="comment"># center</span></span><br><span class="line">      size <span class="operator">=</span> <span class="number">10</span><span class="punctuation">,</span></span><br><span class="line">      color <span class="operator">=</span> <span class="string">&quot;gray&quot;</span><span class="punctuation">,</span></span><br><span class="line">      face <span class="operator">=</span> <span class="string">&quot;italic&quot;</span></span><br><span class="line">    <span class="punctuation">)</span></span><br><span class="line">  <span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<p><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://statsandr.com/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-32-1.png"></p>
<h3 id="Axis-ticks"><a href="#Axis-ticks" class="headerlink" title="Axis ticks"></a>Axis ticks</h3><p>Axis ticks can be adjusted using <code>scale_x_continuous()</code> and <code>scale_y_continuous()</code> for the x and y-axis, respectively:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Adjust ticks</span></span><br><span class="line">p <span class="operator">+</span> scale_x_continuous<span class="punctuation">(</span>breaks <span class="operator">=</span> seq<span class="punctuation">(</span>from <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> to <span class="operator">=</span> <span class="number">7</span><span class="punctuation">,</span> by <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span> <span class="comment"># x-axis</span></span><br><span class="line">  scale_y_continuous<span class="punctuation">(</span>breaks <span class="operator">=</span> seq<span class="punctuation">(</span>from <span class="operator">=</span> <span class="number">10</span><span class="punctuation">,</span> to <span class="operator">=</span> <span class="number">45</span><span class="punctuation">,</span> by <span class="operator">=</span> <span class="number">5</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="comment"># y-axis</span></span><br></pre></td></tr></table></figure>

<p><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://statsandr.com/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-33-1.png"></p>
<h3 id="Log-transformations"><a href="#Log-transformations" class="headerlink" title="Log transformations"></a>Log transformations</h3><p>In some cases, it is useful to plot the log transformation of the variables. This can be done with the <code>scale_x_log10()</code> and <code>scale_y_log10()</code> functions:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">p <span class="operator">+</span> scale_x_log10<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  scale_y_log10<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<p><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://statsandr.com/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-34-1.png"></p>
<h3 id="Limits"><a href="#Limits" class="headerlink" title="Limits"></a>Limits</h3><p>The most convenient way to control the limits of the plot is to use again the <code>scale_x_continuous()</code> and <code>scale_y_continuous()</code> functions in addition to the <code>limits</code> argument:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">p <span class="operator">+</span> scale_x_continuous<span class="punctuation">(</span>limits <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">3</span><span class="punctuation">,</span> <span class="number">6</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  scale_y_continuous<span class="punctuation">(</span>limits <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">20</span><span class="punctuation">,</span> <span class="number">30</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<p><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://statsandr.com/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-35-1.png"></p>
<p>It is also possible to simply take a subset of the dataset with the <code>subset()</code> or <code>filter()</code> function. See how to <a target="_blank" rel="noopener" href="https://statsandr.com/blog/data-manipulation-in-r/#subset-a-data-frame">subset a dataset</a> if you need a reminder.</p>
<h3 id="Scales-for-better-axis-formats"><a href="#Scales-for-better-axis-formats" class="headerlink" title="Scales for better axis formats"></a>Scales for better axis formats</h3><p>Depending on your data, it is possible to format axes in a certain way with the <code>&#123;scales&#125;</code> package. The format I use the most is <code>comma</code> which formats large numbers in a more-readable way.</p>
<p>For this example, we multiply both variables by 10000 to have larger numbers and then we apply the format to the y-axis (only to the y-axis so we can see the difference with the x-axis which is not formatted):</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>dat<span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  aes<span class="punctuation">(</span>x <span class="operator">=</span> displ <span class="operator">*</span> <span class="number">10000</span><span class="punctuation">,</span> y <span class="operator">=</span> hwy <span class="operator">*</span> <span class="number">10000</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  scale_y_continuous<span class="punctuation">(</span>labels <span class="operator">=</span> scales<span class="operator">::</span>comma<span class="punctuation">)</span> <span class="comment"># format y-axis</span></span><br></pre></td></tr></table></figure>

<p><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://statsandr.com/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-36-1.png"></p>
<p>As you can see, numbers on the y-axis are displayed as 200,000, 300,000, etc. instead of 200000, 300000, etc., which makes it more readable.</p>
<p>Another common format is <code>percent</code> to display numbers as percentages:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>dat<span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  aes<span class="punctuation">(</span>x <span class="operator">=</span> displ<span class="punctuation">,</span> y <span class="operator">=</span> hwy <span class="operator">/</span> <span class="number">100</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  scale_y_continuous<span class="punctuation">(</span>labels <span class="operator">=</span> scales<span class="operator">::</span>percent<span class="punctuation">)</span> <span class="comment"># format y-axis</span></span><br></pre></td></tr></table></figure>

<p><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://statsandr.com/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-37-1.png"></p>
<p>These two formats make large numbers and percentages easier to read. Other formats are possible such as using dollar signs, dates etc. See more information in the <a target="_blank" rel="noopener" href="https://scales.r-lib.org/">package’s documentation</a>.</p>
<h3 id="Legend"><a href="#Legend" class="headerlink" title="Legend"></a>Legend</h3><p>By default, the legend is located to the right side of the plot (when there is a legend to be displayed of course).</p>
<p>To control the position of the legend, we need to use the <code>theme()</code> function in addition to the <code>legend.position</code> argument:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">p <span class="operator">+</span> aes<span class="punctuation">(</span>color <span class="operator">=</span> <span class="built_in">class</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>legend.position <span class="operator">=</span> <span class="string">&quot;top&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<p><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://statsandr.com/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-38-1.png"></p>
<p>Replace <code>&quot;top&quot;</code> by <code>&quot;left&quot;</code> or <code>&quot;bottom&quot;</code> to change its position and by <code>&quot;none&quot;</code> to remove it.</p>
<p>The title of the legend can be edited with the <code>labs()</code> layer:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">p <span class="operator">+</span> aes<span class="punctuation">(</span>color <span class="operator">=</span> <span class="built_in">class</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;Car&#x27;s class&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<p><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://statsandr.com/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-39-1.png"></p>
<p>Note that the argument inside <code>labs()</code> must match the one inside the <code>aes()</code> layer (in this case: <code>color</code>).</p>
<p>The title of the legend can also be removed with <code>legend.title = element_blank()</code> inside the <code>theme()</code> layer:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">p <span class="operator">+</span> aes<span class="punctuation">(</span>color <span class="operator">=</span> <span class="built_in">class</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span></span><br><span class="line">    legend.title <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    legend.position <span class="operator">=</span> <span class="string">&quot;bottom&quot;</span></span><br><span class="line">  <span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<p><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://statsandr.com/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-40-1.png"></p>
<p>The legend now appears at the bottom of the plot, without the legend title.</p>
<h3 id="Shape-color-size-and-transparency"><a href="#Shape-color-size-and-transparency" class="headerlink" title="Shape, color, size and transparency"></a>Shape, color, size and transparency</h3><p>There are a very large number of options to improve the quality of the plot or to add additional information. These include:</p>
<ul>
<li>shape,</li>
<li>size,</li>
<li>color, and</li>
<li>alpha (transparency).</li>
</ul>
<p>We can for instance change the shape of all points in a scatter plot by adding <code>shape</code> to <code>geom_point()</code>, or vary the shape according to the values taken by another variable (in that case, the <code>shape</code> argument must be inside <code>aes()</code>):<a target="_blank" rel="noopener" href="https://statsandr.com/blog/graphics-in-r-with-ggplot2/#fn3"><sup>3</sup></a></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Change shape of all points</span></span><br><span class="line">ggplot<span class="punctuation">(</span>dat<span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  aes<span class="punctuation">(</span>x <span class="operator">=</span> displ<span class="punctuation">,</span> y <span class="operator">=</span> hwy<span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>shape <span class="operator">=</span> <span class="number">4</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<p><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://statsandr.com/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-41-1.png"></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Change shape of points based on a categorical variable</span></span><br><span class="line">ggplot<span class="punctuation">(</span>dat<span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  aes<span class="punctuation">(</span>x <span class="operator">=</span> displ<span class="punctuation">,</span> y <span class="operator">=</span> hwy<span class="punctuation">,</span> shape <span class="operator">=</span> drv<span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<p><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://statsandr.com/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-41-2.png"></p>
<p>Following the same principle, we can modify the color, size and transparency of the points based on a <a target="_blank" rel="noopener" href="https://statsandr.com/blog/variable-types-and-examples/#qualitative">qualitative</a> or <a target="_blank" rel="noopener" href="https://statsandr.com/blog/variable-types-and-examples/#quantitative">quantitative</a> variable. Here are some examples:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">p <span class="operator">&lt;-</span> ggplot<span class="punctuation">(</span>dat<span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  aes<span class="punctuation">(</span>x <span class="operator">=</span> displ<span class="punctuation">,</span> y <span class="operator">=</span> hwy<span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Change color for all points</span></span><br><span class="line">p <span class="operator">+</span> geom_point<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;steelblue&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<p><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://statsandr.com/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-42-1.png"></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Change color based on a qualitative variable</span></span><br><span class="line">p <span class="operator">+</span> aes<span class="punctuation">(</span>color <span class="operator">=</span> drv<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<p><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://statsandr.com/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-42-2.png"></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Change color based on a quantitative variable</span></span><br><span class="line">p <span class="operator">+</span> aes<span class="punctuation">(</span>color <span class="operator">=</span> cty<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<p><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://statsandr.com/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-42-3.png"></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Change color based on a criterion (median of cty variable)</span></span><br><span class="line">p <span class="operator">+</span> aes<span class="punctuation">(</span>color <span class="operator">=</span> cty <span class="operator">&gt;</span> median<span class="punctuation">(</span>cty<span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<p><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://statsandr.com/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-42-4.png"></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Change size of all points</span></span><br><span class="line">p <span class="operator">+</span> geom_point<span class="punctuation">(</span>size <span class="operator">=</span> <span class="number">4</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<p><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://statsandr.com/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-42-5.png"></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Change size of points based on a quantitative variable</span></span><br><span class="line">p <span class="operator">+</span> aes<span class="punctuation">(</span>size <span class="operator">=</span> cty<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<p><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://statsandr.com/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-42-6.png"></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Change transparency based on a quantitative variable</span></span><br><span class="line">p <span class="operator">+</span> aes<span class="punctuation">(</span>alpha <span class="operator">=</span> cty<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<p><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://statsandr.com/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-42-7.png"></p>
<p>We can of course mix several options (shape, color, size, alpha) to build more complex graphics:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">p <span class="operator">+</span> geom_point<span class="punctuation">(</span>size <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  aes<span class="punctuation">(</span>color <span class="operator">=</span> drv<span class="punctuation">,</span> shape <span class="operator">=</span> year<span class="punctuation">,</span> alpha <span class="operator">=</span> cty<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<p><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://statsandr.com/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-43-1.png"></p>
<p>If you are unhappy with the default colors, you can change them manually with the <code>scale_colour_manual()</code> layer (for qualitative variables) and the <code>scale_coulour_gradient2()</code> layer (for quantitative variables):</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Change color based on a qualitative variable</span></span><br><span class="line">p <span class="operator">+</span> aes<span class="punctuation">(</span>color <span class="operator">=</span> drv<span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  scale_colour_manual<span class="punctuation">(</span>values <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;red&quot;</span><span class="punctuation">,</span> <span class="string">&quot;blue&quot;</span><span class="punctuation">,</span> <span class="string">&quot;green&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<p><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://statsandr.com/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-44-1.png"></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Change color based on a quantitative variable</span></span><br><span class="line">p <span class="operator">+</span> aes<span class="punctuation">(</span>color <span class="operator">=</span> cty<span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  scale_colour_gradient2<span class="punctuation">(</span></span><br><span class="line">    low <span class="operator">=</span> <span class="string">&quot;green&quot;</span><span class="punctuation">,</span></span><br><span class="line">    mid <span class="operator">=</span> <span class="string">&quot;gray&quot;</span><span class="punctuation">,</span></span><br><span class="line">    high <span class="operator">=</span> <span class="string">&quot;red&quot;</span><span class="punctuation">,</span></span><br><span class="line">    midpoint <span class="operator">=</span> median<span class="punctuation">(</span>dat<span class="operator">$</span>cty<span class="punctuation">)</span></span><br><span class="line">  <span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<p><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://statsandr.com/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-44-2.png"></p>
<p>For your information, you can emulate <code>&#123;ggplot2&#125;</code> default color palette for a desired number of colors and produce a character vector of HEX colors. For example, with 4 colors:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">library<span class="punctuation">(</span>scales<span class="punctuation">)</span></span><br><span class="line">show_col<span class="punctuation">(</span>hue_pal<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">(</span><span class="number">4</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<p><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://statsandr.com/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-45-1.png"></p>
<h3 id="Text-and-labels"><a href="#Text-and-labels" class="headerlink" title="Text and labels"></a>Text and labels</h3><p>To add a label on a point (for example the row number), we can use the <code>geom_text()</code> and <code>aes()</code> functions:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">p <span class="operator">+</span> geom_text<span class="punctuation">(</span>aes<span class="punctuation">(</span>label <span class="operator">=</span> rownames<span class="punctuation">(</span>dat<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">  check_overlap <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span></span><br><span class="line">  size <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span></span><br><span class="line">  vjust <span class="operator">=</span> <span class="operator">-</span><span class="number">1</span></span><br><span class="line"><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<p><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://statsandr.com/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-46-1.png"></p>
<p>To add text on the plot, we use the <code>annotate()</code> function:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">p <span class="operator">+</span> annotate<span class="punctuation">(</span><span class="string">&quot;text&quot;</span><span class="punctuation">,</span></span><br><span class="line">  x <span class="operator">=</span> <span class="number">6</span><span class="punctuation">,</span></span><br><span class="line">  y <span class="operator">=</span> <span class="number">40</span><span class="punctuation">,</span></span><br><span class="line">  label <span class="operator">=</span> <span class="string">&quot;hwy and displ are \n negatively correlated \n (rho = -0.77, p-value &lt; 0.001)&quot;</span><span class="punctuation">,</span></span><br><span class="line">  size <span class="operator">=</span> <span class="number">3</span></span><br><span class="line"><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<p><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://statsandr.com/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-47-1.png"></p>
<p>Read the article on <a target="_blank" rel="noopener" href="https://statsandr.com/blog/correlation-coefficient-and-correlation-test-in-r/">correlation coefficient and correlation test in R</a> to see how I computed the correlation coefficient (rho) and the _p_-value of the correlation test.</p>
<h3 id="Smooth-and-regression-lines"><a href="#Smooth-and-regression-lines" class="headerlink" title="Smooth and regression lines"></a>Smooth and regression lines</h3><p>In a scatter plot, it is possible to add a smooth line fitted to the data:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">p <span class="operator">+</span> geom_smooth<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<p><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://statsandr.com/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-48-1.png"></p>
<p>In the context of simple <a target="_blank" rel="noopener" href="https://statsandr.com/blog/multiple-linear-regression-made-simple/">linear regression</a>, it is often the case that the regression line is displayed on the plot.</p>
<p>This can be done by adding <code>method = lm</code> (<code>lm</code> stands for linear model) in the <code>geom_smooth()</code> layer:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">p <span class="operator">+</span> geom_smooth<span class="punctuation">(</span>method <span class="operator">=</span> lm<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<p><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://statsandr.com/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-49-1.png"></p>
<p>It is also possible to draw a regression line for each level of a categorical variable:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">p <span class="operator">+</span> aes<span class="punctuation">(</span>color <span class="operator">=</span> drv<span class="punctuation">,</span> shape <span class="operator">=</span> drv<span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_smooth<span class="punctuation">(</span>method <span class="operator">=</span> lm<span class="punctuation">,</span> se <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<p><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://statsandr.com/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-50-1.png"></p>
<p>The <code>se = FALSE</code> argument removes the confidence interval around the regression lines.</p>
<h3 id="Facets"><a href="#Facets" class="headerlink" title="Facets"></a>Facets</h3><p><code>facet_grid</code> allows you to divide the same graphic into several panels according to the values of one or two qualitative variables:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># According to one variable</span></span><br><span class="line">p <span class="operator">+</span> facet_grid<span class="punctuation">(</span>. <span class="operator">~</span> drv<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<p><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://statsandr.com/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-51-1.png"></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># According to 2 variables</span></span><br><span class="line">p <span class="operator">+</span> facet_grid<span class="punctuation">(</span>drv <span class="operator">~</span> year<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<p><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://statsandr.com/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-51-2.png"></p>
<p>It is then possible to add a regression line to each facet:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">p <span class="operator">+</span> facet_grid<span class="punctuation">(</span>. <span class="operator">~</span> drv<span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_smooth<span class="punctuation">(</span>method <span class="operator">=</span> lm<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<p><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://statsandr.com/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-52-1.png"></p>
<p><code>facet_wrap()</code> can also be used, as illustrated in this <a target="_blank" rel="noopener" href="https://statsandr.com/blog/graphics-in-r-with-ggplot2/#boxplot">section</a>.</p>
<h3 id="Themes"><a href="#Themes" class="headerlink" title="Themes"></a>Themes</h3><p>Several functions are available in the <code>&#123;ggplot2&#125;</code> package to change the theme of the plot.</p>
<p>The most common themes after the default theme (i.e., <code>theme_gray()</code>) are the black and white (<code>theme_bw()</code>), minimal (<code>theme_minimal()</code>) and classic (<code>theme_classic()</code>) themes:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Black and white theme</span></span><br><span class="line">p <span class="operator">+</span> theme_bw<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<p><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://statsandr.com/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-53-1.png"></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Minimal theme</span></span><br><span class="line">p <span class="operator">+</span> theme_minimal<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<p><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://statsandr.com/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-53-2.png"></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Classic theme</span></span><br><span class="line">p <span class="operator">+</span> theme_classic<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<p><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://statsandr.com/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-53-3.png"></p>
<p>I tend to use the minimal theme for most of my <a target="_blank" rel="noopener" href="https://statsandr.com/blog/getting-started-in-r-markdown/">R Markdown</a> reports as it brings out the patterns and points and not the layout of the plot, but again this is a matter of personal taste. See more themes at <a target="_blank" rel="noopener" href="https://ggplot2.tidyverse.org/reference/ggtheme.html">ggplot2.tidyverse.org&#x2F;reference&#x2F;ggtheme.html</a> and in the <code>&#123;ggthemes&#125;</code> package.</p>
<p>In order to avoid having to change the theme for each plot you create, you can change the theme for the current R session using the <code>theme_set()</code> function as follows:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">theme_set(theme_minimal())</span><br></pre></td></tr></table></figure>

<h3 id="Interactive-plot-with-plotly"><a href="#Interactive-plot-with-plotly" class="headerlink" title="Interactive plot with {plotly}"></a>Interactive plot with <code>&#123;plotly&#125;</code></h3><p>You can easily make your plots created with <code>&#123;ggplot2&#125;</code> interactive with the <code>&#123;plotly&#125;</code> package:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">library<span class="punctuation">(</span>plotly<span class="punctuation">)</span></span><br><span class="line">ggplotly<span class="punctuation">(</span>p <span class="operator">+</span> aes<span class="punctuation">(</span>color <span class="operator">=</span> year<span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<p>You can now hover over a point to display more information about that point. There is also the possibility to zoom in and out, to download the plot, to select some observations, etc. More information about <code>&#123;plotly&#125;</code> for R can be found <a target="_blank" rel="noopener" href="https://plotly.com/r/">here</a>.</p>
<h3 id="Combine-plots-with-patchwork"><a href="#Combine-plots-with-patchwork" class="headerlink" title="Combine plots with {patchwork}"></a>Combine plots with <code>&#123;patchwork&#125;</code></h3><p>There are several ways to combine plots made in <code>&#123;ggplot2&#125;</code>. In my opinion, the most convenient way is with the <code>&#123;patchwork&#125;</code> package using symbols such as <code>+</code>, <code>/</code> and parentheses.</p>
<p>We first need to create some plots and save them:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">p_a <span class="operator">&lt;-</span> ggplot<span class="punctuation">(</span>dat<span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  aes<span class="punctuation">(</span>x <span class="operator">=</span> displ<span class="punctuation">,</span> y <span class="operator">=</span> hwy<span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">p_b <span class="operator">&lt;-</span> ggplot<span class="punctuation">(</span>dat<span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  aes<span class="punctuation">(</span>x <span class="operator">=</span> hwy<span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_histogram<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">p_c <span class="operator">&lt;-</span> ggplot<span class="punctuation">(</span>dat<span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  aes<span class="punctuation">(</span>x <span class="operator">=</span> drv<span class="punctuation">,</span> y <span class="operator">=</span> hwy<span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_boxplot<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<p>Now that we have 3 plots saved in our environment, we can combine them. To have plots <strong>next to each other</strong> simply use the <code>+</code> symbol:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">library<span class="punctuation">(</span>patchwork<span class="punctuation">)</span></span><br><span class="line">p_a <span class="operator">+</span> p_b <span class="operator">+</span> p_c</span><br></pre></td></tr></table></figure>

<p><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://statsandr.com/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-57-1.png"></p>
<p>To display them <strong>above each other</strong> simply use the <code>/</code> symbol:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">p_a <span class="operator">/</span> p_b <span class="operator">/</span> p_c</span><br></pre></td></tr></table></figure>

<p><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://statsandr.com/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-58-1.png"></p>
<p>And finally, to combine them <strong>above and next</strong> to each other, mix <code>+</code>, <code>/</code> and parentheses:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">p_a <span class="operator">+</span> p_b <span class="operator">/</span> p_c</span><br></pre></td></tr></table></figure>

<p><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://statsandr.com/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-59-1.png"></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">(</span>p_a <span class="operator">+</span> p_b<span class="punctuation">)</span> <span class="operator">/</span> p_c</span><br></pre></td></tr></table></figure>

<p><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://statsandr.com/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-59-2.png"></p>
<p>See more ways to combine plots with:</p>
<ul>
<li><code>grid.arrange()</code> from the <code>&#123;gridExtra&#125;</code> package</li>
<li><code>plot_grid()</code> from the <code>&#123;cowplot&#125;</code> package</li>
</ul>
<h3 id="Flip-coordinates"><a href="#Flip-coordinates" class="headerlink" title="Flip coordinates"></a>Flip coordinates</h3><p>Flipping coordinates of your plot is useful to create horizontal boxplots, or when labels of a variable are so long that they overlap each other on the x-axis. See with and without flipping coordinates below:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># without flipping coordinates</span></span><br><span class="line">p1 <span class="operator">&lt;-</span> ggplot<span class="punctuation">(</span>dat<span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  aes<span class="punctuation">(</span>x <span class="operator">=</span> <span class="built_in">class</span><span class="punctuation">,</span> y <span class="operator">=</span> hwy<span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_boxplot<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># with flipping coordinates</span></span><br><span class="line">p2 <span class="operator">&lt;-</span> ggplot<span class="punctuation">(</span>dat<span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  aes<span class="punctuation">(</span>x <span class="operator">=</span> <span class="built_in">class</span><span class="punctuation">,</span> y <span class="operator">=</span> hwy<span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_boxplot<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  coord_flip<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">library<span class="punctuation">(</span>patchwork<span class="punctuation">)</span></span><br><span class="line">p1 <span class="operator">+</span> p2 <span class="comment"># left: without flipping, right: with flipping</span></span><br></pre></td></tr></table></figure>

<p><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://statsandr.com/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-60-1.png"></p>
<p>This can be done with many types of plot, not only with boxplots. For instance, if a categorical variable has many levels or the labels are long, it is usually best to flip the coordinates for a better visual:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>dat<span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  aes<span class="punctuation">(</span>x <span class="operator">=</span> <span class="built_in">class</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_bar<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  coord_flip<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<p><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://statsandr.com/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-61-1.png"></p>
<h3 id="Save-plot"><a href="#Save-plot" class="headerlink" title="Save plot"></a>Save plot</h3><p>The <code>ggsave()</code> function will save the most recent plot in your current <a target="_blank" rel="noopener" href="https://statsandr.com/blog/how-to-import-an-excel-file-in-rstudio/#r-working-directory">working directory</a> unless you specify a path to another folder:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>dat<span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  aes<span class="punctuation">(</span>x <span class="operator">=</span> displ<span class="punctuation">,</span> y <span class="operator">=</span> hwy<span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">ggsave<span class="punctuation">(</span><span class="string">&quot;plot1.pdf&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<p>You can also specify the width, height and resolution (<code>dpi</code>) as follows:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ggsave<span class="punctuation">(</span><span class="string">&quot;plot1.pdf&quot;</span><span class="punctuation">,</span></span><br><span class="line">  width <span class="operator">=</span> <span class="number">12</span><span class="punctuation">,</span></span><br><span class="line">  height <span class="operator">=</span> <span class="number">12</span><span class="punctuation">,</span></span><br><span class="line">  units <span class="operator">=</span> <span class="string">&quot;cm&quot;</span><span class="punctuation">,</span></span><br><span class="line">  dpi <span class="operator">=</span> <span class="number">300</span></span><br><span class="line"><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<h3 id="Managing-dates"><a href="#Managing-dates" class="headerlink" title="Managing dates"></a>Managing dates</h3><p>If the time variable in your dataset is in date format, the <code>&#123;ggplot2&#125;</code> package recognizes the date format and automatically uses a specific type for the axis ticks.</p>
<p>There is no time variable with a date format in our dataset, so let’s create a new variable of this type thanks to the <code>as.Date()</code> function:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dat<span class="operator">$</span>date <span class="operator">&lt;-</span> as.Date<span class="punctuation">(</span><span class="string">&quot;2020-08-21&quot;</span><span class="punctuation">)</span> <span class="operator">-</span> <span class="number">0</span><span class="operator">:</span><span class="punctuation">(</span>nrow<span class="punctuation">(</span>dat<span class="punctuation">)</span> <span class="operator">-</span> <span class="number">1</span><span class="punctuation">)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>See the first 6 observations of this date variable and its class</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">head<span class="punctuation">(</span>dat<span class="operator">$</span>date<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## [1] &quot;2020-08-21&quot; &quot;2020-08-20&quot; &quot;2020-08-19&quot; &quot;2020-08-18&quot; &quot;2020-08-17&quot;</span></span><br><span class="line"><span class="comment">## [6] &quot;2020-08-16&quot;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">str<span class="punctuation">(</span>dat<span class="operator">$</span>date<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##  Date[1:234], format: &quot;2020-08-21&quot; &quot;2020-08-20&quot; &quot;2020-08-19&quot; &quot;2020-08-18&quot; &quot;2020-08-17&quot; ...</span></span><br></pre></td></tr></table></figure>

<p>The new variable <code>date</code> is correctly specified in a date format.</p>
<p>Most of the time, with a time variable, we want to create a line plot with the date on the X-axis and another continuous variable on the Y-axis, like the following plot for example:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">p <span class="operator">&lt;-</span> ggplot<span class="punctuation">(</span>dat<span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> hwy<span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_line<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line">p</span><br></pre></td></tr></table></figure>

<p><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://statsandr.com/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-66-1.png"></p>
<p>As soon as the time variable is recognized as a date, we can use the <code>scale_x_date()</code> layer to change the format displayed on the X-axis. The following table shows the most frequent date formats:</p>
<p><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://statsandr.com/blog/2020-08-21-graphics-in-r-with-ggplot2_files/date%20formats%20in%20R.png" alt="Source: www.statmethods.net"></p>
<p>Source: <a target="_blank" rel="noopener" href="http://www.statmethods.net/">www.statmethods.net</a></p>
<p>Run <code>?strptime()</code> to see many more date formats available in R.</p>
<p>For this example, let’s add the year in addition to the unabbreviated month:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">p <span class="operator">+</span> scale_x_date<span class="punctuation">(</span>date_labels <span class="operator">=</span> <span class="string">&quot;%B %Y&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<p><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://statsandr.com/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-67-1.png"></p>
<p>It also possible to control the breaks to display on the X-axis with the <code>date_breaks</code> argument. For this example, let’s say we want to display the day as number and the abbreviated month for each interval of 10 days:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">p <span class="operator">+</span> scale_x_date<span class="punctuation">(</span>date_breaks <span class="operator">=</span> <span class="string">&quot;10 days&quot;</span><span class="punctuation">,</span> date_labels <span class="operator">=</span> <span class="string">&quot;%d %b&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<p><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://statsandr.com/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-68-1.png"></p>
<p>If labels displayed on the X-axis are unreadable because they overlap each other, you can rotate them with the <code>theme()</code> layer and the <code>angle</code> argument:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">p <span class="operator">+</span> scale_x_date<span class="punctuation">(</span>date_breaks <span class="operator">=</span> <span class="string">&quot;10 days&quot;</span><span class="punctuation">,</span> date_labels <span class="operator">=</span> <span class="string">&quot;%d %b&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>axis.text.x <span class="operator">=</span> element_text<span class="punctuation">(</span>angle <span class="operator">=</span> <span class="number">60</span><span class="punctuation">,</span> hjust <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<p><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://statsandr.com/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-69-1.png"></p>
<h3 id="Highlight-data-with-gghighlight"><a href="#Highlight-data-with-gghighlight" class="headerlink" title="Highlight data with {gghighlight}"></a>Highlight data with <code>&#123;gghighlight&#125;</code></h3><p>The <code>&#123;gghighlight&#125;</code> package allows, as its name suggests, to highlight some data directly on your ggplot. The highlighted data (that you define) are shown in bright color and the rest in gray.</p>
<p>Below example of how it works for a scatter plot, boxplot, barplot and histogram.</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">library<span class="punctuation">(</span>gghighlight<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># scatter plot</span></span><br><span class="line">ggplot<span class="punctuation">(</span>mpg<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> displ<span class="punctuation">,</span> y <span class="operator">=</span> hwy<span class="punctuation">,</span> color <span class="operator">=</span> cyl<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  gghighlight<span class="punctuation">(</span>cyl <span class="operator">==</span> <span class="string">&quot;8&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>legend.position <span class="operator">=</span> <span class="string">&quot;none&quot;</span><span class="punctuation">)</span> <span class="comment"># remove legend</span></span><br></pre></td></tr></table></figure>

<p><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://statsandr.com/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-70-1.png"></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># boxplot</span></span><br><span class="line">ggplot<span class="punctuation">(</span>dat<span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  aes<span class="punctuation">(</span>x <span class="operator">=</span> drv<span class="punctuation">,</span> y <span class="operator">=</span> hwy<span class="punctuation">,</span> fill <span class="operator">=</span> drv<span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_boxplot<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  gghighlight<span class="punctuation">(</span>drv <span class="operator">%in%</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;r&quot;</span><span class="punctuation">,</span> <span class="string">&quot;4&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>legend.position <span class="operator">=</span> <span class="string">&quot;none&quot;</span><span class="punctuation">)</span> <span class="comment"># remove legend</span></span><br></pre></td></tr></table></figure>

<p><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://statsandr.com/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-70-2.png"></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># barplot</span></span><br><span class="line">ggplot<span class="punctuation">(</span>dat<span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  aes<span class="punctuation">(</span>x <span class="operator">=</span> drv<span class="punctuation">,</span> fill <span class="operator">=</span> drv<span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_bar<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  gghighlight<span class="punctuation">(</span>drv <span class="operator">==</span> <span class="string">&quot;f&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<p><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://statsandr.com/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-70-3.png"></p>
<p>As you can see, the <code>gghighlight()</code> layer accepts different types of conditions, but also several of them at the same time:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># histogram</span></span><br><span class="line">ggplot<span class="punctuation">(</span>dat<span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  aes<span class="punctuation">(</span>x <span class="operator">=</span> hwy<span class="punctuation">,</span> fill <span class="operator">=</span> year<span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_histogram<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  gghighlight<span class="punctuation">(</span>displ <span class="operator">&amp;</span>gt; <span class="number">2</span> <span class="operator">&amp;</span>amp; year <span class="operator">==</span> <span class="string">&quot;1999&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<p><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://statsandr.com/blog/2020-08-21-graphics-in-r-with-ggplot2_files/figure-html/unnamed-chunk-71-1.png"></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://lambda.bz">乘月又乘风</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a target="_blank" rel="noopener" href="https://statsandr.com/blog/graphics-in-r-with-ggplot2/">https://statsandr.com/blog/graphics-in-r-with-ggplot2/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://lambda.bz" target="_blank">甘露园技术栈</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/R/">R</a><a class="post-meta__tags" href="/tags/ggplot2/">ggplot2</a></div><div class="post_share"></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/25f40947.html" title="JavaScript学习资料备忘"><img class="cover" src= "/image/800x600-loading-81.gif" data-lazy-src="https://tron.oss-cn-beijing.aliyuncs.com/2024/04/29/gabriel-heinzer-js.webp" onerror="onerror=null;src='https://tron.oss-cn-beijing.aliyuncs.com/2024/04/25/404.webp'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">JavaScript学习资料备忘</div></div></a></div><div class="next-post pull-right"><a href="/posts/9f3a32c3.html" title="Python Requests Retry Failed Requests"><img class="cover" src= "/image/800x600-loading-81.gif" data-lazy-src="https://tron.oss-cn-beijing.aliyuncs.com/2024/04/27/markus-spiske-AaEQmoufHLk-unsplash.webp" onerror="onerror=null;src='https://tron.oss-cn-beijing.aliyuncs.com/2024/04/25/404.webp'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Python Requests Retry Failed Requests</div></div></a></div></nav><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="waline-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://tron.oss-cn-beijing.aliyuncs.com/2024/04/26/me.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">乘月又乘风</div><div class="author-info__description">Superman is here!</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">11</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">15</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">8</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/icesharp"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/icesharp" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="/atom.xml" target="_blank" title="RSS"><i class="fa-solid fa-square-rss" style="color: #FFA500;"></i></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Scatter-plot"><span class="toc-number">1.</span> <span class="toc-text">Scatter plot</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Line-plot"><span class="toc-number">2.</span> <span class="toc-text">Line plot</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Combination-of-line-and-points"><span class="toc-number">3.</span> <span class="toc-text">Combination of line and points</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Histogram"><span class="toc-number">4.</span> <span class="toc-text">Histogram</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Density-plot"><span class="toc-number">5.</span> <span class="toc-text">Density plot</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Combination-of-histogram-and-densities"><span class="toc-number">6.</span> <span class="toc-text">Combination of histogram and densities</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Dotplot"><span class="toc-number">7.</span> <span class="toc-text">Dotplot</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Boxplot"><span class="toc-number">8.</span> <span class="toc-text">Boxplot</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Barplot"><span class="toc-number">9.</span> <span class="toc-text">Barplot</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Raincloud-plot"><span class="toc-number">10.</span> <span class="toc-text">Raincloud plot</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Further-personalization"><span class="toc-number">11.</span> <span class="toc-text">Further personalization</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Title-and-axis-labels"><span class="toc-number">11.1.</span> <span class="toc-text">Title and axis labels</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Axis-ticks"><span class="toc-number">11.2.</span> <span class="toc-text">Axis ticks</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Log-transformations"><span class="toc-number">11.3.</span> <span class="toc-text">Log transformations</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Limits"><span class="toc-number">11.4.</span> <span class="toc-text">Limits</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Scales-for-better-axis-formats"><span class="toc-number">11.5.</span> <span class="toc-text">Scales for better axis formats</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Legend"><span class="toc-number">11.6.</span> <span class="toc-text">Legend</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Shape-color-size-and-transparency"><span class="toc-number">11.7.</span> <span class="toc-text">Shape, color, size and transparency</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Text-and-labels"><span class="toc-number">11.8.</span> <span class="toc-text">Text and labels</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Smooth-and-regression-lines"><span class="toc-number">11.9.</span> <span class="toc-text">Smooth and regression lines</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Facets"><span class="toc-number">11.10.</span> <span class="toc-text">Facets</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Themes"><span class="toc-number">11.11.</span> <span class="toc-text">Themes</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Interactive-plot-with-plotly"><span class="toc-number">11.12.</span> <span class="toc-text">Interactive plot with {plotly}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Combine-plots-with-patchwork"><span class="toc-number">11.13.</span> <span class="toc-text">Combine plots with {patchwork}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Flip-coordinates"><span class="toc-number">11.14.</span> <span class="toc-text">Flip coordinates</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Save-plot"><span class="toc-number">11.15.</span> <span class="toc-text">Save plot</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Managing-dates"><span class="toc-number">11.16.</span> <span class="toc-text">Managing dates</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Highlight-data-with-gghighlight"><span class="toc-number">11.17.</span> <span class="toc-text">Highlight data with {gghighlight}</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/6891fdec.html" title="五一，一到假期就过得特别快。"><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://tron.oss-cn-beijing.aliyuncs.com/2024/05/06/freestocks.webp" onerror="this.onerror=null;this.src='https://tron.oss-cn-beijing.aliyuncs.com/2024/04/25/404.webp'" alt="五一，一到假期就过得特别快。"/></a><div class="content"><a class="title" href="/posts/6891fdec.html" title="五一，一到假期就过得特别快。">五一，一到假期就过得特别快。</a><time datetime="2024-05-06T03:07:18.000Z" title="发表于 2024-05-06 11:07:18">2024-05-06</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/25f40947.html" title="JavaScript学习资料备忘"><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://tron.oss-cn-beijing.aliyuncs.com/2024/04/29/gabriel-heinzer-js.webp" onerror="this.onerror=null;this.src='https://tron.oss-cn-beijing.aliyuncs.com/2024/04/25/404.webp'" alt="JavaScript学习资料备忘"/></a><div class="content"><a class="title" href="/posts/25f40947.html" title="JavaScript学习资料备忘">JavaScript学习资料备忘</a><time datetime="2024-04-29T15:51:39.000Z" title="发表于 2024-04-29 23:51:39">2024-04-29</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/85f45869.html" title="在R语言中使用ggplot2绘图"><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://tron.oss-cn-beijing.aliyuncs.com/2024/04/26/gabriel-heinzer.webp" onerror="this.onerror=null;this.src='https://tron.oss-cn-beijing.aliyuncs.com/2024/04/25/404.webp'" alt="在R语言中使用ggplot2绘图"/></a><div class="content"><a class="title" href="/posts/85f45869.html" title="在R语言中使用ggplot2绘图">在R语言中使用ggplot2绘图</a><time datetime="2024-04-27T18:25:57.000Z" title="发表于 2024-04-28 02:25:57">2024-04-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/9f3a32c3.html" title="Python Requests Retry Failed Requests"><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://tron.oss-cn-beijing.aliyuncs.com/2024/04/27/markus-spiske-AaEQmoufHLk-unsplash.webp" onerror="this.onerror=null;this.src='https://tron.oss-cn-beijing.aliyuncs.com/2024/04/25/404.webp'" alt="Python Requests Retry Failed Requests"/></a><div class="content"><a class="title" href="/posts/9f3a32c3.html" title="Python Requests Retry Failed Requests">Python Requests Retry Failed Requests</a><time datetime="2024-04-27T07:25:17.000Z" title="发表于 2024-04-27 15:25:17">2024-04-27</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/6bfb980.html" title="typer 命令行程序框架"><img src= "/image/800x600-loading-81.gif" data-lazy-src="https://tron.oss-cn-beijing.aliyuncs.com/2024/04/26/gabriel-heinzer.webp" onerror="this.onerror=null;this.src='https://tron.oss-cn-beijing.aliyuncs.com/2024/04/25/404.webp'" alt="typer 命令行程序框架"/></a><div class="content"><a class="title" href="/posts/6bfb980.html" title="typer 命令行程序框架">typer 命令行程序框架</a><time datetime="2024-04-26T08:25:57.000Z" title="发表于 2024-04-26 16:25:57">2024-04-26</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2024 By 乘月又乘风</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="https://cdn.bootcss.com/fancyapps-ui/5.0.33/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.bootcss.com/instant.page/5.2.0/instantpage.min.js" type="module"></script><script src="https://cdn.bootcss.com/vanilla-lazyload/17.8.8/lazyload.iife.min.js"></script><div class="js-pjax"><script>(() => {
  let initFn = window.walineFn || null

  const initWaline = (Fn) => {
    const waline = Fn(Object.assign({
      el: '#waline-wrap',
      serverURL: 'https://c.lambda.bz',
      pageview: false,
      dark: 'html[data-theme="dark"]',
      path: window.location.pathname,
      comment: false,
    }, null))

    const destroyWaline = () => {
      waline.destroy()
    }

    btf.addGlobalFn('pjax', destroyWaline, 'destroyWaline')
  }

  const loadWaline = async () => {
    if (initFn) initWaline(initFn)
    else {
      await getCSS('https://cdn.bootcss.com/waline/3.1.2/waline.min.css')
      const { init } = await import('https://cdn.bootcss.com/waline/3.1.2/waline.min.js')
      initFn = init || Waline.init
      initWaline(initFn)
      window.walineFn = initFn
    }
  }

  if ('Waline' === 'Waline' || !false) {
    if (false) btf.loadComment(document.getElementById('waline-wrap'),loadWaline)
    else setTimeout(loadWaline, 0)
  } else {
    window.loadOtherComment = loadWaline
  }
})()</script></div><canvas id="universe"></canvas><script defer src="/js/universe.js"></script><script>window.si = window.si || function () { (window.siq = window.siq || []).push(arguments); };</script><script defer src="/_vercel/speed-insights/script.js"></script><script id="canvas_nest" defer="defer" color="255,0,255" opacity="0.6" zIndex="-1" count="66" mobile="false" src="https://cdn.bootcss.com/butterfly-extsrc/1.1.3/canvas-nest.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=4.13.0"></script></div></div></body></html>